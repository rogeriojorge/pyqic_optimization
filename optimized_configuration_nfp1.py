from qic import Qic
from qic.calculate_r2 import evaluate_X2c_X2s_QI
def optimized_configuration_nfp1(nphi=131,order = "r3"):
    rc      = [1.0,0.0,-0.3841789158961201,0.0,0.0718091458915539,0.0,-0.008104348666913945,0.0,0.0,0.0,0.0,0.0,0.0]
    zs      = [0.0,0.0,-0.34689586210531065,0.0,0.07753693169884435,0.0,-0.010872223261117534,0.0,9.707664554363704e-06,0.0,-3.5920758053211764e-06,0.0,2.2715586820765966e-06]
    B0_vals = [1.0,0.18521248573622617]
    omn_method = "non-zone"
    k_buffer = 3
    p_buffer = 2
    d_over_curvature_cvals = []
    d_over_curvature_spline = [0.6244515396665049,0.5856390364553758,0.5228901109802389,0.6406533038977942,0.5652244536183211,0.5381764349184741]
    delta   = 0.1
    d_svals = []
    nfp     = 1
    iota    = -0.6667809787896375
    p2    = 0.0
    X2s_svals = []
    X2c_cvals = [0.0]
    X2s_cvals = [0.05486297082546836,-0.39429679069699175,-0.49848690755196234,0.09291898142399287,0.42036233360759984,0.9244937875710552,1.0243218443831277,1.3032291772078815,1.286574324716577,1.2065514588049466,0.5902802874673055,-0.08766382784890003,-0.8201403025782805,-1.202698159800006,-1.411243698085454,-1.3493059190067,-1.242709972892387,-1.0361022041509884,-0.8775869734377211,-0.6942366510433853,-0.5782503186084725,-0.45436562785927964,-0.38906074505398247,-0.3151317884837133,-0.2874358663130505,-0.24869161191131586,-0.24716844651934983,-0.23453256199334185,-0.2538501638444686,-0.2639712599605161,-0.3020095857307011,-0.3318172079344416,-0.38306805539121913,-0.42286937837093,-0.47248419969523464,-0.5014437075369852,-0.5232559999496972,-0.5110529675630067,-0.47448186833405137,-0.39460858060088005,-0.2839201025287456,-0.1360578551675726,0.029901560012109273,0.20930032003653665,0.3806323837536496,0.5361559372020038,0.658892419559701,0.7436805414072336,0.7800737250256791,0.7659972521410119,0.6981185794524222,0.5811984156819451,0.42638923515828914,0.25279615169245134,0.08489234951152587,-0.05897174636393255,-0.16204077623357468,-0.21596552463876864,-0.22138259173689925,-0.201692665944932,-0.17555957304961545,-0.14630642623441478,-0.10684186828458875,-0.06122246779087775,-0.021242316146743337,-0.002897135863181558,-0.012285170861578317,-0.04693739785890932,-0.09245600932174186,-0.13524328059359222,-0.16758801519111682,-0.19393196251333533,-0.2173212896295896,-0.2220583211865,-0.1860841343453051,-0.09736565587156511,0.03328308658719862,0.19580970495594519,0.36903017459407417,0.5330460352983932,0.6637608636986309,0.7489373425742805,0.7809499436279855,0.760853332612791,0.6919444170768038,0.5803728908514081,0.4354763564331485,0.2668667545014073,0.09002700606069694,-0.08373193790406072,-0.23664717538585317,-0.3631652055000121,-0.4502542498888454,-0.504815863375597,-0.5198388509481192,-0.5139199456911084,-0.4801006560680836,-0.44392454467739934,-0.3917884678173011,-0.3534937503005462,-0.3054757862507914,-0.2821246156439381,-0.2493253545958007,-0.247851323095293,-0.2337432902045462,-0.2566103796130467,-0.26358363808641233,-0.315786279599379,-0.3509511551539497,-0.4440753460827345,-0.5200781791900874,-0.6697719849992982,-0.7961036521884763,-1.004212455986025,-1.152930924462483,-1.3515194274664433,-1.376411705138636,-1.3390728140594166,-0.9352563213247677,-0.40600905258414444,0.4313503176181797,0.971110979113037,1.3696086262636131,1.2384558558543872,1.1972509389782422,0.8984028350130614,0.6765066736140786,0.14617303246213031,-0.2734543246680448,-0.5070403869854764,-0.22530365139058897]
    X2c_svals = [-1.113348659393203,2.061060376231851,1.5159084883995262,-0.19935952085898226,-0.693142368910117,-1.227854369256499,-1.1277300516414221,-1.2120027757561567,-1.0239839221517912,-0.8296962250956987,-0.3533662831312143,0.04599412913239017,0.3797421248873351,0.4954222956223721,0.5224282202393654,0.4547270282842278,0.3874968886764113,0.3048131068820746,0.24905007836017856,0.19458971273936607,0.16387279346836495,0.13303073322911668,0.11988973653557929,0.10374104351196788,0.10222495204418658,0.096302525206723,0.10474040379885607,0.10906807612570642,0.1297064463218766,0.14819677203524273,0.1861500643651152,0.22425479417144986,0.2834190135941661,0.3419141687437756,0.4167649052767102,0.48170200242514905,0.5465549982200005,0.5796049836566066,0.5835841906890562,0.5258228428631123,0.4095800253995539,0.2123892428918561,-0.05049933418719486,-0.3824577391105728,-0.752840197266302,-1.148567467711993,-1.5302312658472548,-1.8747457258690994,-2.1378455286511464,-2.2865108786024355,-2.2749604369209693,-2.073329087433197,-1.6707324220622217,-1.0924753896871735,-0.40668130201746566,0.31515739901702333,0.9738435024505488,1.4747018744058482,1.7408972853842595,1.8598914796015438,1.9467488396780233,2.0239227860615436,1.9538212514121562,1.6417908842275617,1.060116316798726,1.0129226641807267,-0.858696908444037,-1.4888031047172334,-1.8920397658434713,-2.0370371079067424,-1.9908315904716143,-1.8955460959908854,-1.7980065140806696,-1.5866816728029973,-1.1654767207938102,-0.5405719022834842,0.16523582243919585,0.875228161357128,1.493227608012199,1.9611811868992783,2.22849215186514,2.3012898624860085,2.2015735727951613,1.971833354468372,1.651272927138274,1.277065828343396,0.8844637095845076,0.5006626086766548,0.15608511323636698,-0.134183030635452,-0.35049576871762256,-0.4969319557428607,-0.5688273285378619,-0.5882913424548257,-0.5581724293743147,-0.5077456768795438,-0.43577988915933924,-0.36957460047296814,-0.2986361599884,-0.2462685386686266,-0.19418827103454173,-0.1634157480244934,-0.13146262905390718,-0.11892882328442002,-0.10214602394367266,-0.10235494765102053,-0.09637005395531557,-0.10655493248231016,-0.11039197371631676,-0.132004490182337,-0.14865946738845076,-0.18794400618588933,-0.22439933382634236,-0.2911595141524711,-0.35178071397085797,-0.4429550607409568,-0.4930452843056913,-0.5316385951867102,-0.41608214435769725,-0.20416159598318612,0.24693465004891982,0.6371418644091781,1.0372589577142022,1.0921547960325173,1.2438462169909077,1.1179708708758644,1.0336781392194139,0.2852835686311141,-0.7303054337228947,-2.135632205575436,-2.31236015595363]
    # B20QI_deviation_max = 0.07033225962837797
    # B2cQI_deviation_max = 2.322809722343777e-09
    # B2sQI_deviation_max = 0.5675446489286753
    # Max |X20| = 2.0736360365781312
    # Max |Y20| = 2.5072688546875295
    # Max |Y2c| = 3.665487289051437
    # Max |Y2s| = 3.037025204502191
    # Min r_singularity = 0.15969585360642558
    # Max |X3c1| = 2.0313813704895556
    # Max |X3s1| = 3.0512243085447643
    # Max |Y3c1| = 11.496728242988663
    # Max |Y3s1| = 0.8766501072897359
    # gradgradB inverse length: 7.391713487838086
    # d2_volume_d_psi2 = 252.03010097978648
    # max curvature_d(0) = 1.6923002610553843
    # max d_d(0) = 1.0567137136935765
    # max gradB inverse length: 1.4901006715539113
    # Max elongation = 5.431349256764555
    # Initial objective = 4.264733135698644
    # Final objective = 2.144138853293941
    stel = Qic(omn_method = omn_method, delta=delta, p_buffer=p_buffer, p2=p2, k_buffer=k_buffer, rc=rc,zs=zs, nfp=nfp, B0_vals=B0_vals, d_svals=d_svals, nphi=nphi, omn=True, B2c_cvals=X2c_cvals, B2s_svals=X2s_svals, order=order, d_over_curvature_cvals=d_over_curvature_cvals, B2c_svals=X2c_svals, B2s_cvals=X2s_cvals, d_over_curvature_spline=d_over_curvature_spline)
    stel._set_names();stel.calculate()
    min_geo_qi_consistency = stel.min_geo_qi_consistency(order = 1);X2c, X2s = evaluate_X2c_X2s_QI(stel, X2s_in=0)
    stel.B2c_svals=X2c;stel.B2s_cvals=X2s;stel._set_names();stel.calculate()
    return stel