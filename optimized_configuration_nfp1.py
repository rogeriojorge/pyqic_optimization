from qic import Qic
from qic.calculate_r2 import evaluate_X2c_X2s_QI
def optimized_configuration_nfp1(nphi=151,order = "r3"):
    rc      = [1.0,0.0,-0.38459096578742813,0.0,0.07255166768694969,0.0,-0.008389824911919029,0.0,0.0,0.0,0.0,0.0,0.0]
    zs      = [0.0,0.0,-0.3598486634563086,0.0,0.07682306494919214,0.0,-0.010191685435420011,0.0,4.036107432173228e-06,0.0,-4.3969762817997976e-06,0.0,2.3550448463950584e-06]
    B0_vals = [1.0,0.18123366163472843]
    omn_method = "non-zone"
    k_buffer = 3
    p_buffer = 2
    d_over_curvature_cvals = []
    d_over_curvature_spline = [0.6852709627042584,0.586389221291665,0.5485587911285738,0.6421705864127942,0.5577318431769437,0.5412652605051589]
    delta   = 0.1
    d_svals = []
    nfp     = 1
    iota    = -0.6708481607159201
    p2    = 0.0
    X2s_svals = []
    X2c_cvals = [0.0]
    X2s_cvals = [0.042744070115767384,-0.31907670289720913,-0.383697148239613,0.1109830946976389,0.4396652725364943,0.8954062532535673,0.9690085555032952,1.1096163791822806,1.0416820702552303,1.1700545959715347,1.0712536606286411,0.9307757860666884,0.4381314024450914,-0.04599490664446066,-0.6060005325271535,-0.9415088032344503,-1.201151417563312,-1.2480571111137988,-1.2591465938891147,-1.1516695359458768,-1.0646425119119505,-0.9215158738310651,-0.8216836606694925,-0.6923072631916907,-0.6080820058867571,-0.50394371545812,-0.44060539437287793,-0.36195726941841266,-0.31986380691142474,-0.2660750374198965,-0.2455707617495059,-0.2162872612241932,-0.2170262160909043,-0.21060164805577578,-0.22997982093728697,-0.24209195141383677,-0.2743625056851479,-0.2974601067573989,-0.33355929800786455,-0.356831938930067,-0.3846220612099063,-0.3945693483151445,-0.40008805934062514,-0.38275338998908615,-0.35372162092245535,-0.29954006030579916,-0.23117984664257427,-0.14102604846663064,-0.041146106629270526,0.07068718042977674,0.181787921825216,0.29105403648233585,0.3870022772238212,0.46769743828735283,0.5245993006195677,0.5567388757927122,0.5598082343866664,0.5354375655821978,0.4853272266555119,0.41557820035439397,0.3343797712894099,0.24965610304389443,0.16883191675238926,0.09373358909433437,0.029848337121542418,-0.014938787082646197,-0.027335011075322175,-0.008972879526938312,0.02257104243258844,0.043355203473585666,0.04447978153001486,0.03153447547736491,0.01632179350486039,0.0053883016781763595,0.0005250111474966285,-0.0012326959755212556,-0.0003905496101262273,0.002699179259546672,0.011575474077394248,0.025377477219895406,0.04035024534073008,0.04494066971213235,0.030659789844443768,0.0009809744955996571,-0.024515007651552775,-0.022477696763917823,0.012146504141638726,0.07183561131262264,0.1430675943736456,0.22272709781907427,0.30597479624239193,0.3894849730294518,0.46364712744821074,0.5211078106850029,0.5545061359426273,0.5604963338591464,0.5382691107635503,0.4887683484309233,0.4162188752604147,0.32386288521812784,0.21943854780061303,0.1069048629950743,-0.003812227854753101,-0.11014376841841535,-0.2018241898803276,-0.28026767970616057,-0.33630823522021647,-0.3770343077478648,-0.3941022576318647,-0.40034763041513977,-0.3863630361914424,-0.3699043503902468,-0.3381972056107011,-0.3133277086622552,-0.2774262730252307,-0.2569773535093878,-0.22797885775405818,-0.2217839630142001,-0.2075785835197453,-0.2221708596752793,-0.22734731461908209,-0.2661246457914087,-0.2923235492803793,-0.3563779985839015,-0.4034461311489338,-0.4931761416713455,-0.5607103658324223,-0.6769990520962867,-0.7638551516849681,-0.9047519410559371,-1.0006022725060655,-1.1460909221413602,-1.2073943022455897,-1.2876052508719387,-1.2036641791720832,-1.0794598967660405,-0.700575013840801,-0.28513994546287075,0.32525504226245194,0.7366035002019711,1.101680541076512,1.0956275794383783,1.1405510399783154,1.0295013028931599,1.0818225266330823,0.8876337519757017,0.6603059755851958,0.17736563896139484,-0.20181668973608557,-0.40755335850567764,-0.16849817211127163]
    X2c_svals = [-1.0037315433759197,1.925473308219057,1.3476824772999245,-0.2757810036648284,-0.8436083575190884,-1.3927955304771875,-1.2595555213977745,-1.2299883946086263,-0.9988667645395026,-0.9808002743719836,-0.7913491173559947,-0.6099055890474536,-0.2561213894617663,0.02411841948244376,0.28668096048189895,0.40443617089747164,0.4721190071103727,0.45302430387227116,0.42676392659266194,0.3692065685506036,0.327582323668316,0.27649667038700604,0.24441151597639896,0.20750513846952598,0.18649848569741753,0.16034668771856717,0.14716559072223553,0.1281339040562757,0.12091183434436795,0.1079958758253037,0.10743688206001777,0.10224826876964875,0.11101571811554833,0.11663148031593358,0.13787639855905545,0.15703570219960264,0.1923983166357772,0.2252794349100186,0.27251764418878477,0.31413021410072317,0.36442261018776306,0.40192224279495353,0.43770225426027126,0.44931196098663706,0.44519419343665473,0.40393632167281873,0.33385037802940853,0.21801443838330073,0.0680781845907715,-0.12516816193019478,-0.3445452055363606,-0.5906249611471568,-0.8412300520378618,-1.0897210377123687,-1.311285234029938,-1.494515271892582,-1.6159458647999314,-1.6645859605839401,-1.6279541679474239,-1.5073809851961992,-1.3149483509354576,-1.0677464225232198,-0.7882646752184456,-0.4799356672057739,-0.16853611916744463,0.0936589225953758,0.19192265644081108,0.07132059623923702,-0.2059636599490951,-0.4627111751737361,-0.5696203152550328,-0.5029334996322511,-0.34366871133449284,-0.16622144390392402,-0.030123315518972432,0.4953918511891054,-0.031381149909917146,0.09846444776641386,0.2726536622378351,0.44047218910132174,0.5532315846508147,0.5079984997575284,0.2940794331817399,0.008150191927744879,-0.17914999389908418,-0.1461912915331852,0.07096022773994555,0.3797486202598822,0.6884561850634068,0.9803907223736866,1.2369250774521179,1.450855563935158,1.5958858930483744,1.661240264577421,1.6404007635335596,1.5412288114106736,1.3776520834451287,1.1656845471067137,0.9258420441607996,0.6723988096246283,0.42546287798635946,0.1936349146200303,-0.006451805954006157,-0.17417408787781744,-0.29816101629051245,-0.3866941242801374,-0.4331561740465793,-0.4530351518398405,-0.4414442955081725,-0.4176745486189805,-0.37506005097963213,-0.33375812292257695,-0.28330608973750293,-0.24340157905839624,-0.19962499155745156,-0.1710976136118581,-0.14032456200996204,-0.12611917588098673,-0.10902793605635008,-0.10781556132762714,-0.10204440706152201,-0.11071138030867918,-0.11309382718838376,-0.1288545314492723,-0.13725937801001445,-0.1592883303503571,-0.17383968214715634,-0.20414266463131395,-0.2273836190950687,-0.2701848306712698,-0.3047537907631478,-0.361811079800225,-0.40109005276492166,-0.456217219947818,-0.4602084626714336,-0.4497534613461655,-0.32068560376346356,-0.14437910308233712,0.18325945070202024,0.46436591329386756,0.7814233179324476,0.8798093818519077,1.0446642972494888,1.0858673237782344,1.33096629296755,1.2969081394985336,1.1763390823037385,0.40146384901439264,-0.6229501080166373,-1.9814805093547072,-1.9988438995287214]
    # B20QI_deviation_max = 0.04551275441286928
    # B2cQI_deviation_max = 3.109970059256284e-10
    # B2sQI_deviation_max = 0.4662533406762783
    # Max |X20| = 1.6401730696810073
    # Max |Y20| = 2.2487803968746483
    # Max |Y2c| = 3.521273414828171
    # Max |Y2s| = 2.4749701270430062
    # Min r_singularity = 0.1776254135619499
    # Max |X3c1| = 1.7939188630288405
    # Max |X3s1| = 2.901436042983551
    # Max |Y3c1| = 10.589969351589959
    # Max |Y3s1| = 0.4699653003536787
    # gradgradB inverse length: 7.795389471364933
    # d2_volume_d_psi2 = 257.2176092727175
    # max curvature_d(0) = 1.683398202639662
    # max d_d(0) = 1.1532651010646406
    # max gradB inverse length: 1.499701203087287
    # Max elongation = 5.103179584763492
    # Initial objective = 2.402525263157764
    # Final objective = 1.7182994924066253
    stel = Qic(omn_method = omn_method, delta=delta, p_buffer=p_buffer, p2=p2, k_buffer=k_buffer, rc=rc,zs=zs, nfp=nfp, B0_vals=B0_vals, d_svals=d_svals, nphi=nphi, omn=True, B2c_cvals=X2c_cvals, B2s_svals=X2s_svals, order=order, d_over_curvature_cvals=d_over_curvature_cvals, B2c_svals=X2c_svals, B2s_cvals=X2s_cvals, d_over_curvature_spline=d_over_curvature_spline)
    stel._set_names();stel.calculate()
    min_geo_qi_consistency = stel.min_geo_qi_consistency(order = 1);X2c, X2s = evaluate_X2c_X2s_QI(stel, X2s_in=0)
    stel.B2c_svals=X2c;stel.B2s_cvals=X2s;stel._set_names();stel.calculate()
    return stel