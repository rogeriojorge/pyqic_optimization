from qic import Qic
from qic.calculate_r2 import evaluate_X2c_X2s_QI
def optimized_configuration_nfp1(nphi=151,order = "r3"):
    rc      = [1.0,0.0,-0.4145476973520619,0.0,0.0844951861154409,0.0,-0.009829180464923948,0.0,0.0,0.0,0.0,0.0,0.0]
    zs      = [0.0,0.0,-0.42284055491855077,0.0,0.08919284162657387,0.0,-0.00996788112536994,0.0,-0.0003707492306407143,0.0,3.008317310364713e-06,0.0,-5.142271737363572e-07]
    B0_vals = [1.0,0.21442867644455416]
    omn_method = "non-zone"
    k_buffer = 3
    p_buffer = 2
    d_over_curvature_cvals = []
    d_over_curvature_spline = [0.940977109815613,0.733232596204163,0.5707409973992478,0.6022511679445715,0.5469561456925354,0.5214513931597342]
    delta   = 0.1
    d_svals = []
    nfp     = 1
    iota    = -0.7567979787859164
    p2    = 0.0
    X2s_svals = []
    X2c_cvals = [0.0]
    X2s_cvals = [-0.024109155461131303,-0.2106313043506575,-0.2642369394412823,-0.12095865362962194,-0.23459344357235087,-0.32109851228202374,-0.482685902250645,-0.19349492240072555,0.23197188614946698,0.7483412739816614,0.7570011156517882,0.4829685946897932,-0.08802170303159809,-0.5099946479979826,-0.8356229411071918,-0.8857958008479501,-0.8460249044263948,-0.6540377834773375,-0.47538868335002127,-0.25302350377887134,-0.09936928998617948,0.0517371986005253,0.12598084857262917,0.19131884777327432,0.19502480532374641,0.20011108586074372,0.16436621962313638,0.14185736689540024,0.09482182626069932,0.06741973540914187,0.024550918222158498,0.0019340827625748348,-0.032300045343313634,-0.04876137225132411,-0.0752973151980389,-0.08735125631383592,-0.10861625592683245,-0.1185642988646774,-0.13706389254870946,-0.14705375664685902,-0.1649506323106741,-0.17651360812482236,-0.19489507615858803,-0.20786645684583888,-0.22532955396388402,-0.23627065970467556,-0.2474821625366686,-0.24885305443735353,-0.24491710754932125,-0.22722354252069527,-0.19993640156350065,-0.1578939838594811,-0.1068986413100504,-0.04601786298567862,0.017055208950931093,0.08035327703507915,0.13652967778258074,0.18390887861047006,0.21885105149161782,0.24309953122305428,0.2587915367606506,0.2706578134891685,0.28153244066904687,0.28778020678654725,0.2784658964694554,0.23854864646277466,0.1699020920744554,0.09846864270416683,0.05975213307945814,0.06044584563084293,0.07584540329785017,0.07866304295215841,0.0618268794971921,0.035157725351364334,0.011955209217101439,0.0011432640617682383,0.006535352957895728,0.025902121104752998,0.052749191158006255,0.07402786345552588,0.07820740952920237,0.06491622076851411,0.05601097286117877,0.08111133289105214,0.14490200975958076,0.21912377364650903,0.2696992754797798,0.28802869558071054,0.2850026722973564,0.27462553413070234,0.2632196565060744,0.2488032722966589,0.22822783907803282,0.1963466255142308,0.15371208235083428,0.09922269802407137,0.038783411200687665,-0.026058992178427665,-0.08692601543884035,-0.14302250624017307,-0.18670795779822177,-0.2206873176947112,-0.2395340766053893,-0.24994851998504602,-0.2477009447148628,-0.24208272814521947,-0.22791218254887774,-0.21560838769963808,-0.19748223158408051,-0.18470594715650174,-0.16655472475127234,-0.15548110765066453,-0.137698407343619,-0.12775777006581315,-0.10877954807866906,-0.09814765387551104,-0.07566014399653803,-0.06209623369990885,-0.033577786237201854,-0.014823464794263148,0.021887724272898354,0.04697811145483135,0.09155991025966115,0.11954294747008752,0.16441192771672744,0.18163034811152692,0.2068021279967293,0.18636639533625948,0.16079987290639208,0.06988805935669141,-0.033823256780675603,-0.21164127852384562,-0.38686021315226904,-0.6133519575959484,-0.7737746279087071,-0.90813808072744,-0.8533102320895148,-0.6683181691189347,-0.21837885176153793,0.26757862896007345,0.7335705189401821,0.7652569158092352,0.4646712820082976,-0.10595720951882903,-0.3914580608095405,-0.42635217523927593,-0.22481858291497098,-0.16690505306523037,-0.18783880636966407,-0.263872119297506,-0.12097809189062066]
    X2c_svals = [0.7485845041609267,1.6883466173192225,1.2432129338903901,0.40743542377879793,0.6194670248744649,0.7000333537504125,0.8983406873980946,0.3147051213912763,-0.33549598739145226,-0.9756287312985786,-0.899611558135379,-0.5281794366171921,0.08933509635081244,0.48410598024314627,0.7473606788766695,0.7518272944036614,0.6863218238896737,0.5107580322565295,0.359968173537579,0.18712875199777795,0.07230503450032612,-0.03730893247915564,-0.09068093696540896,-0.13841809730558335,-0.1427734839998928,-0.1491738384640187,-0.12550236354697777,-0.1115457659128012,-0.07715968270904945,-0.05702132227772348,-0.021664185098091406,-0.0017865174343637486,0.03131963752338413,0.04975115947896442,0.08099941512971984,0.09923366452514631,0.1304840313135016,0.15078840723136494,0.1847056346637268,0.21013466005989048,0.25009565330644684,0.2841086656596028,0.3331602292763013,0.37753073456701686,0.43496810114829554,0.4849199085281052,0.5402268159556869,0.5779727556861725,0.6054703931668955,0.598190234781552,0.5608249947329133,0.4722061987362729,0.34111710504937265,0.15682706938185656,-0.06214222566327022,-0.3134190722978397,-0.570946277671432,-0.8260065014048156,-1.057883957185331,-1.2677412002492996,-1.4601041414944285,-1.6576464176282668,-1.8791367634634815,-2.103336421389616,-2.2414348839663916,-2.129510143197755,-1.6967663545628147,-1.112240510166765,-0.7742134586677312,-0.9153780887113975,-1.3773963549707213,-1.7782307782939173,-1.8444710850995514,-1.536220480601835,-0.9714277537880943,-0.6506193213290966,0.7436438745856824,1.3382871857978167,1.7602084197402796,1.8209417281207865,1.5203345348752784,1.0409991079344985,0.7626598359105748,0.9573870435420413,1.5056944923690758,2.0284809522005984,2.2451581013600244,2.172458370357646,1.9596129955927521,1.7300504422706258,1.5256606241100699,1.3315321784668357,1.131146657423539,0.9035118499963977,0.6581464986052239,0.39603819827598,0.14453511502857086,-0.0907975638062743,-0.283500949309683,-0.43703758321819336,-0.5349848877682729,-0.5933599096923757,-0.6046737478736998,-0.5926941625561506,-0.551974246004087,-0.5071436113527437,-0.44901816282940765,-0.39961381133172247,-0.34445634290473104,-0.3033070194736297,-0.2575949988679743,-0.22659422421341113,-0.18920885812494811,-0.16563139005589014,-0.13317164409245477,-0.11357986066115458,-0.08286916332318883,-0.064470793750219,-0.033107856696225686,-0.013911787669451971,0.019604052023126952,0.040282318901345426,0.07543600078160481,0.09503014601363817,0.12670012474683243,0.13639822932140194,0.15220821566103376,0.1352680611582996,0.11585317189067011,0.050327444466577914,-0.024517745955390163,-0.15555116090880183,-0.29040575227075377,-0.47370349759388736,-0.6193011449742273,-0.7586574772872648,-0.7493831347311116,-0.6214261764689091,-0.2165672982774089,0.28517673742055594,0.8471037917138272,0.9662436768626133,0.6483066970048624,-0.16543476635799068,-0.6949809258679216,-0.8790207245199526,-0.5543658646562833,-0.5145140689106664,-0.7794599024472207,-1.7081976576984101,-1.8996162880810132]
    # B20QI_deviation_max = 0.08680254944399968
    # B2cQI_deviation_max = 6.95502988534713e-10
    # B2sQI_deviation_max = 0.20159499178274648
    # Max |X20| = 2.1443038031643646
    # Max |Y20| = 2.037667206608037
    # Max |Y2c| = 2.060914830390951
    # Max |Y2s| = 1.886747463513979
    # Min r_singularity = 0.23036333639245532
    # Max |X3c1| = 1.073340416391449
    # Max |X3s1| = 4.060174816611447
    # Max |Y3c1| = 5.181093754081159
    # Max |Y3s1| = 1.5369711707315057
    # gradgradB inverse length: 8.7318406445979
    # d2_volume_d_psi2 = 233.68343968227876
    # max curvature_d(0) = 1.4376944430235743
    # max d_d(0) = 1.3522495754624309
    # max gradB inverse length: 1.6596119131040008
    # Max elongation = 4.594580461549798
    # Initial objective = 3.0007831227860855
    # Final objective = 3.64459909131097
    stel = Qic(omn_method = omn_method, delta=delta, p_buffer=p_buffer, p2=p2, k_buffer=k_buffer, rc=rc,zs=zs, nfp=nfp, B0_vals=B0_vals, d_svals=d_svals, nphi=nphi, omn=True, B2c_cvals=X2c_cvals, B2s_svals=X2s_svals, order=order, d_over_curvature_cvals=d_over_curvature_cvals, B2c_svals=X2c_svals, B2s_cvals=X2s_cvals, d_over_curvature_spline=d_over_curvature_spline)
    stel._set_names();stel.calculate()
    min_geo_qi_consistency = stel.min_geo_qi_consistency(order = 1);X2c, X2s = evaluate_X2c_X2s_QI(stel, X2s_in=0)
    stel.B2c_svals=X2c;stel.B2s_cvals=X2s;stel._set_names();stel.calculate()
    return stel