from qic import Qic
from qic.calculate_r2 import evaluate_X2c_X2s_QI
def optimized_configuration_nfp2(nphi=101,order = "r3"):
    rc      = [1.0,0.0,-0.08040297834061966,0.0,0.005773078448735066,0.0,-5.792736122237974e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]
    zs      = [0.0,0.0,-0.09857879877644113,0.0,0.009078680689978007,0.0,0.0004178433263287984,0.0,7.84832597080386e-06,0.0,-6.019408690102574e-07,0.0,1.3413693004269447e-07,0.0,1.4688345268925702e-07,0.0,-8.600467886165271e-08,0.0,4.172537468496238e-08,0.0,-1.099753830863863e-08]
    B0_vals = [1.0,0.18276213693029125]
    omn_method = "non-zone-fourier"
    k_buffer = 1
    p_buffer = 2
    d_over_curvature_cvals = []
    d_over_curvature_spline = [0.45277910839704594,0.531174251269148,0.5870654324979185,0.5618535495908981,0.5090928112669275,0.5182867819871342]
    delta   = 0.8
    d_svals = []
    nfp     = 2
    iota    = -1.2144514870419911
    p2    = 0.0
    X2s_svals = []
    X2c_cvals = [0.0]
    X2s_cvals = [0.0034172517181365685,0.12248863280182327,0.27678440705644797,0.31741014902509546,0.17558533061641168,-0.11562349562878581,-0.4736159874420924,-0.8153664958148115,-1.0788313831087055,-1.2267610636420088,-1.2443824343757786,-1.13694531631404,-0.9284963864004264,-0.6603423729892244,-0.38572064376684434,-0.15864991376681653,-0.01892469238088966,0.01934313747632528,-0.03226953737042747,-0.14783128799962653,-0.29974404179087005,-0.46364890972908523,-0.6178826694796868,-0.7464299999780554,-0.8467871739706352,-0.9331046781488305,-1.027092243609293,-1.1423234367674027,-1.275371330289152,-1.4100411883152992,-1.5275166248961696,-1.611585801971219,-1.6480380996159727,-1.6257376915759283,-1.5423735112356909,-1.4091985156016416,-1.2487810259849395,-1.086662794500409,-0.9427877643182034,-0.8271186677127099,-0.739971297343703,-0.6750957873846231,-0.6232483858807496,-0.5742369272254467,-0.517685095209959,-0.44377476700140756,-0.34610103276579673,-0.22862874267309327,-0.11315296684556828,-0.031732100964092846,-0.0001402519424871531,-0.01568920683050302,-0.08086524454388255,-0.18832628144117863,-0.308467931464719,-0.4139643785968795,-0.4954109297276038,-0.5567333333457171,-0.6071089992857731,-0.6568596919976522,-0.7162946320622603,-0.795111133614435,-0.9009059035242082,-1.0359660012382284,-1.1937661207195103,-1.3574586629473377,-1.5025705131888722,-1.6044715592512782,-1.647495371880821,-1.6296811736436463,-1.5599821729072072,-1.4519700918614775,-1.3210427414653416,-1.185328050496853,-1.0629503422859903,-0.9626033133498555,-0.8760546078992854,-0.7826248925266559,-0.6640635911529363,-0.5171085138731468,-0.35417017947617163,-0.19569838945511484,-0.06510193875267711,0.01099878064030382,0.004986330207654235,-0.10108389672770822,-0.3023453523509266,-0.5667297635376108,-0.8432820613373312,-1.0769716064788768,-1.2216594302180444,-1.2472480528608427,-1.1421433455916845,-0.914221014988955,-0.5929178584319313,-0.2319375031589278,0.09146228852362408,0.29049316838252714,0.3087246851046515,0.17794017844873827,0.030097051951758682]
    X2c_svals = [-0.10658879995968476,-0.9543631179131434,-1.230262601952559,-0.9854169028783404,-0.41836913535023246,0.2234520708938454,0.7703665982005441,1.146971745841708,1.3407852336537882,1.3710311809085864,1.2697009022385208,1.0732788126643542,0.8205396816409369,0.5521118875808951,0.30805665964750034,0.12210289265219126,0.014152812430047793,-0.014169103071045639,0.023337271460774387,0.10639968177568047,0.21646172985395407,0.3387419419503541,0.4604957110256534,0.5720735290931477,0.672508406081787,0.7733118594815788,0.893778901049479,1.0493578741026417,1.24230354995469,1.4617809738806757,1.6905126298802344,1.9089078112820872,2.0940743520240934,2.2208790007502524,2.2704677988812065,2.2411862041071684,2.152321714270189,2.0372923244227827,1.9315532473896333,1.8623677570801649,1.8441137215063887,1.878681794362716,1.9584772621816264,2.0671039904193806,2.1756614239267154,2.234737181157435,2.168196060114542,1.8894324331078058,1.3692962148012982,0.7139899047113679,0.022100778999687744,-0.49434018255544143,-1.157045070207781,-1.7406967846993215,-2.1024387598692242,-2.2309645070406865,-2.204057576068886,-2.105223209589987,-1.992592183490763,-1.9008665709975434,-1.8499731722802104,-1.8502997789901936,-1.90344024857392,-1.9994280294588052,-2.1150589968944176,-2.2167152358457387,-2.2689243218258337,-2.246506325818886,-2.144003272382332,-1.9755669790621042,-1.7655044239775128,-1.5379197532089683,-1.313302916099161,-1.109840413253791,-0.9413107001921366,-0.8103188464679981,-0.705179560447864,-0.606475633352234,-0.4991083658543696,-0.37996600714819384,-0.256522254693813,-0.1408802575210608,-0.04696428690936394,0.008015385297318147,0.0037000949111182747,-0.07698729172933352,-0.23828236234246034,-0.4661832786039086,-0.7307768229805497,-0.9933109916320664,-1.2129237876444878,-1.3501246815862211,-1.3676106796321794,-1.2313505633560924,-0.916391463750518,-0.42172480838540716,0.20222614351806986,0.8192299954215013,1.1998702586396903,1.1086033770508823,0.46930568377362175]
    # B20QI_deviation_max = 0.0004639107625791783
    # B2cQI_deviation_max = 1.8614390029370043e-09
    # B2sQI_deviation_max = 0.0010426377021227895
    # Max |X20| = 2.1208361030376053
    # Max |Y20| = 6.278185251186628
    # Max |Y2c| = 4.169346426871579
    # Max |Y2s| = 1.8719030124248826
    # Min r_singularity = 0.11165706370118683
    # Max |X3c1| = 0.6043557282085478
    # Max |X3s1| = 1.233650640901445
    # Max |Y3c1| = 4.722067818311835
    # Max |Y3s1| = 0.5925861911494962
    # gradgradB inverse length: 4.611501586602716
    # d2_volume_d_psi2 = 271.4402994492413
    # max curvature_d(0) = 1.3924855493237074
    # max d_d(0) = 0.6309986603782789
    # max gradB inverse length: 3.053091681751574
    # Max elongation = 4.644353162208626
    # Initial objective = 4.339116067933078
    # Final objective = 4.214801255380263
    stel = Qic(omn_method = omn_method, delta=delta, p_buffer=p_buffer, p2=p2, k_buffer=k_buffer, rc=rc,zs=zs, nfp=nfp, B0_vals=B0_vals, d_svals=d_svals, nphi=nphi, omn=True, B2c_cvals=X2c_cvals, B2s_svals=X2s_svals, order=order, d_over_curvature_cvals=d_over_curvature_cvals, B2c_svals=X2c_svals, B2s_cvals=X2s_cvals, d_over_curvature_spline=d_over_curvature_spline)
    stel._set_names();stel.calculate()
    min_geo_qi_consistency = stel.min_geo_qi_consistency(order = 1);X2c, X2s = evaluate_X2c_X2s_QI(stel, X2s_in=0)
    stel.B2c_svals=X2c;stel.B2s_cvals=X2s;stel._set_names();stel.calculate()
    return stel